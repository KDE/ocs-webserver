(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{17:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(5);function i(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(r,!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],n=!0,a=!1,c=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw c}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function p(e,t){var r=s(Object(n.useState)((function(){try{var r=window.localStorage.getItem(e);return r?JSON.parse(r):t}catch(e){return console.log(e),t}})),2),a=r[0],c=r[1];return[a,function(t){try{var r=t instanceof Function?t(a):t;c(r),window.localStorage.setItem(e,JSON.stringify(r))}catch(e){console.log(e)}}]}function m(e){var t,r,n=a.a.createElement("svg",{fill:"currentColor",preserveAspectRatio:"xMidYMid meet",height:"1em",width:"1em",viewBox:"0 0 40 40",className:"play-icon"},a.a.createElement("g",null,a.a.createElement("path",{d:"m20.1 2.9q4.7 0 8.6 2.3t6.3 6.2 2.3 8.6-2.3 8.6-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3z m8.6 18.3q0.7-0.4 0.7-1.2t-0.7-1.2l-12.1-7.2q-0.7-0.4-1.5 0-0.7 0.4-0.7 1.3v14.2q0 0.9 0.7 1.3 0.4 0.2 0.8 0.2 0.3 0 0.7-0.2z"}))),c=a.a.createElement("svg",{fill:"currentColor",preserveAspectRatio:"xMidYMid meet",height:"1em",width:"1em",viewBox:"0 0 40 40",className:"pause-icon"},a.a.createElement("g",null,a.a.createElement("path",{d:"m18.7 26.4v-12.8q0-0.3-0.2-0.5t-0.5-0.2h-5.7q-0.3 0-0.5 0.2t-0.2 0.5v12.8q0 0.3 0.2 0.5t0.5 0.2h5.7q0.3 0 0.5-0.2t0.2-0.5z m10 0v-12.8q0-0.3-0.2-0.5t-0.5-0.2h-5.7q-0.3 0-0.5 0.2t-0.2 0.5v12.8q0 0.3 0.2 0.5t0.5 0.2h5.7q0.3 0 0.5-0.2t0.2-0.5z m8.6-6.4q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z"}))),i=a.a.createElement("svg",{fill:"currentColor",preserveAspectRatio:"xMidYMid meet",height:"1em",width:"1em",viewBox:"0 0 40 40",className:"prev-icon"},a.a.createElement("g",null,a.a.createElement("path",{d:"m15.9 20l14.1-10v20z m-5.9-10h3.4v20h-3.4v-20z"}))),o=a.a.createElement("svg",{fill:"currentColor",preserveAspectRatio:"xMidYMid meet",height:"1em",width:"1em",viewBox:"0 0 40 40",className:"next-icon"},a.a.createElement("g",null,a.a.createElement("path",{d:"m26.6 10h3.4v20h-3.4v-20z m-16.6 20v-20l14.1 10z"})));t=!0===e.isPlaying?!0===e.isMobile?a.a.createElement("span",{className:"pause-icon-wrapper",onTouchStart:function(){return e.onPauseClick()}},c):a.a.createElement("span",{className:"pause-icon-wrapper",onClick:function(){return e.onPauseClick()}},c):!0===e.isMobile?a.a.createElement("span",{className:"play-icon-wrapper",onTouchStart:function(){return e.onPlayClick()}},n):a.a.createElement("span",{className:"play-icon-wrapper",onClick:function(){return e.onPlayClick()}},n),r=!0===e.isMobile?a.a.createElement("div",{className:"music-player-audio-control"},a.a.createElement("span",{onTouchStart:function(){return e.onPrevTrackPlayClick()}},i),t,a.a.createElement("span",{onTouchStart:function(){return e.onNextTrackPlayClick()}},o)):a.a.createElement("div",{className:"music-player-audio-control"},a.a.createElement("span",{onClick:function(){return e.onPrevTrackPlayClick()}},i),t,a.a.createElement("span",{onClick:function(){return e.onNextTrackPlayClick()}},o));var l="music-player-controls-bar ";return e.isPlaying&&(l+="is-playing"),a.a.createElement("div",{id:"music-player-control-panel"},a.a.createElement("div",{className:l},a.a.createElement("div",{className:"music-player-controls-wrapper"},r),a.a.createElement("div",{className:"track-number-display"},parseInt(e.playIndex+1)+" / "+e.items.length)))}t.default=function(e){var t,r,o=a.a.useContext(c.a),u=o.productBrowseState,d=o.productBrowseDispatch,f=s(Object(n.useState)(0),2),y=f[0],v=f[1],g=(t=y,r=Object(n.useRef)(),Object(n.useEffect)((function(){r.current=t}),[t]),r.current),h=s(Object(n.useState)(),2),w=h[0],E=h[1],b=s(Object(n.useState)(),2),j=b[0],P=b[1],O=[];e.items.forEach((function(e,t){var r=l({},e,{played:0,stopped:0});O.push(r)}));var S=s(Object(n.useState)(O),2),k=S[0],T=S[1],x=e.containerWidth<600,N=s(Object(n.useState)(x),2),C=N[0],I=(N[1],s(p("audioTrackUrl",null),2)),_=(I[0],I[1]),M=s(p("audioTrackIsPlaying",!1),2),q=(M[0],M[1]),A=s(p("audioTrackProductImage",null),2),B=(A[0],A[1]),z=s(p("audioTrackProductInfo",null),2),R=(z[0],z[1]);function D(t,r){var n=document.getElementById("music-player-container-"+e.product.project_id).getElementsByTagName("audio"),a=r||y,c=e.items[a].musicSrc;(!1===j||n[0].currentTime&&0===n[0].currentTime||!0===t)&&(n[0].src=c),_(c),B(e.imgUrl),R(e.product),n[0].play(),E(!0),q(!0),P(!1),function(t,r){var n=k.find((function(e){return e.musicSrc===t})),a=r||k.findIndex((function(e){return e.musicSrc===t})),c=l({},n,{played:n.played+1}),o=[].concat(i(k.slice(0,a)),[c],i(k.slice(a+1,k.length)));if(0===k[a].played){var u="https://"+window.location.hostname+"/p/"+e.product.project_id+"/startmediaviewajax?collection_id="+n.collection_id+"&file_id="+n.id+"&type_id=2";$.ajax({url:u}).done((function(e){var t=l({},n,{mediaViewId:e.MediaViewId,played:n.played+1}),r=[].concat(i(k.slice(0,a)),[t],i(k.slice(a+1,k.length)));T(r)}))}else T(o)}(c,r)}function J(){document.getElementById("music-player-container-"+e.product.project_id).getElementsByTagName("audio")[0].pause(),E(!1),q(!1),P(!0),U(e.items[y].musicSrc)}function U(t){var r=k.find((function(e){return e.musicSrc===t})),n=k.findIndex((function(e){return e.musicSrc===t})),a=l({},r,{stopped:r.stopped+1}),c=[].concat(i(k.slice(0,n)),[a],i(k.slice(n+1,k.length)));if(0===k[n].stopped){var o="https://"+window.location.hostname+"/p/"+e.product.project_id+"/stopmediaviewajax?media_view_id="+k[n].mediaViewId;$.ajax({url:o}).done((function(e){T(c)}))}else T(c)}return Object(n.useEffect)((function(){var t=document.getElementById("music-player-container-"+e.product.project_id).getElementsByTagName("audio"),r=e.items[y].musicSrc;t[0].src=r,t[0].volume=.5}),[]),Object(n.useEffect)((function(){w&&D(!0),j&&(g===y?D():D(!0)),!0===w&&U(e.items[g].musicSrc)}),[y]),a.a.useEffect((function(){u.current===e.product.project_id?!0===u.isPlaying?D(!0):J():!0===w&&J()}),[u.current,u.isPlaying]),a.a.createElement("div",{id:"music-player-container-"+e.product.project_id,className:"product-browse-music-player-wrapper"},a.a.createElement("audio",{volume:.5,id:"music-player-audio-"+e.product.project_id}),a.a.createElement(m,{playIndex:y,isPlaying:w,isPaused:j,isMobile:C,onPlayClick:function(t){d({type:"SET_CURRENT_ITEM",itemId:e.product.project_id,pIndex:y})},onPauseClick:function(){d({type:"PAUSE"})},onPrevTrackPlayClick:function(){var t;t=0===y?e.items.length-1:y-1,v(t)},onNextTrackPlayClick:function(){var t;t=y+1===e.items.length?0:y+1,v(t)},items:e.items}))}}}]);