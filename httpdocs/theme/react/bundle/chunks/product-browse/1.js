(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{17:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(5);function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(n,!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,c=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,c=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw c}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(e){var t,n,r=a.a.createElement("svg",{fill:"currentColor",preserveAspectRatio:"xMidYMid meet",height:"1em",width:"1em",viewBox:"0 0 40 40",className:"play-icon"},a.a.createElement("g",null,a.a.createElement("path",{d:"m20.1 2.9q4.7 0 8.6 2.3t6.3 6.2 2.3 8.6-2.3 8.6-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3z m8.6 18.3q0.7-0.4 0.7-1.2t-0.7-1.2l-12.1-7.2q-0.7-0.4-1.5 0-0.7 0.4-0.7 1.3v14.2q0 0.9 0.7 1.3 0.4 0.2 0.8 0.2 0.3 0 0.7-0.2z"}))),c=a.a.createElement("svg",{fill:"currentColor",preserveAspectRatio:"xMidYMid meet",height:"1em",width:"1em",viewBox:"0 0 40 40",className:"pause-icon"},a.a.createElement("g",null,a.a.createElement("path",{d:"m18.7 26.4v-12.8q0-0.3-0.2-0.5t-0.5-0.2h-5.7q-0.3 0-0.5 0.2t-0.2 0.5v12.8q0 0.3 0.2 0.5t0.5 0.2h5.7q0.3 0 0.5-0.2t0.2-0.5z m10 0v-12.8q0-0.3-0.2-0.5t-0.5-0.2h-5.7q-0.3 0-0.5 0.2t-0.2 0.5v12.8q0 0.3 0.2 0.5t0.5 0.2h5.7q0.3 0 0.5-0.2t0.2-0.5z m8.6-6.4q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z"}))),i=a.a.createElement("svg",{fill:"currentColor",preserveAspectRatio:"xMidYMid meet",height:"1em",width:"1em",viewBox:"0 0 40 40",className:"prev-icon"},a.a.createElement("g",null,a.a.createElement("path",{d:"m15.9 20l14.1-10v20z m-5.9-10h3.4v20h-3.4v-20z"}))),o=a.a.createElement("svg",{fill:"currentColor",preserveAspectRatio:"xMidYMid meet",height:"1em",width:"1em",viewBox:"0 0 40 40",className:"next-icon"},a.a.createElement("g",null,a.a.createElement("path",{d:"m26.6 10h3.4v20h-3.4v-20z m-16.6 20v-20l14.1 10z"})));t=!0===e.isPlaying?!0===e.isMobile?a.a.createElement("span",{onTouchStart:function(){return e.onPauseClick()}},c):a.a.createElement("span",{onClick:function(){return e.onPauseClick()}},c):!0===e.isMobile?a.a.createElement("span",{onTouchStart:function(){return e.onPlayClick()}},r):a.a.createElement("span",{onClick:function(){return e.onPlayClick()}},r),n=!0===e.isMobile?a.a.createElement("div",{className:"music-player-audio-control"},a.a.createElement("span",{onTouchStart:function(){return e.onPrevTrackPlayClick()}},i),t,a.a.createElement("span",{onTouchStart:function(){return e.onNextTrackPlayClick()}},o)):a.a.createElement("div",{className:"music-player-audio-control"},a.a.createElement("span",{onClick:function(){return e.onPrevTrackPlayClick()}},i),t,a.a.createElement("span",{onClick:function(){return e.onNextTrackPlayClick()}},o));var l="music-player-controls-bar ";return e.isPlaying&&(l+="is-playing"),a.a.createElement("div",{id:"music-player-control-panel"},a.a.createElement("div",{className:l},a.a.createElement("div",{className:"music-player-controls-wrapper"},n),a.a.createElement("div",{className:"track-number-display"},parseInt(e.playIndex+1)+" / "+e.items.length)))}t.default=function(e){var t,n,o=a.a.useContext(c.a),u=o.productBrowseState,p=o.productBrowseDispatch,d=s(Object(r.useState)(0),2),f=d[0],y=d[1],v=(t=f,n=Object(r.useRef)(),Object(r.useEffect)((function(){n.current=t}),[t]),n.current),h=s(Object(r.useState)(),2),g=h[0],E=h[1],b=s(Object(r.useState)(),2),w=b[0],j=b[1],P=[];e.items.forEach((function(e,t){var n=l({},e,{played:0,stopped:0});P.push(n)}));var O=s(Object(r.useState)(P),2),S=O[0],k=O[1],x=e.containerWidth<600,C=s(Object(r.useState)(x),2),T=C[0];function N(t,n){var r=document.getElementById("music-player-container-"+e.product.project_id).getElementsByTagName("audio"),a=n||f,c=e.items[a].musicSrc;(!1===w||r[0].currentTime&&0===r[0].currentTime||!0===t)&&(r[0].src=c),r[0].play(),E(!0),j(!1),function(t,n){var r=S.find((function(e){return e.musicSrc===t})),a=n||S.findIndex((function(e){return e.musicSrc===t})),c=l({},r,{played:r.played+1}),o=[].concat(i(S.slice(0,a)),[c],i(S.slice(a+1,S.length)));if(0===S[a].played){var u="https://"+window.location.hostname+"/p/"+e.product.project_id+"/startmediaviewajax?collection_id="+r.collection_id+"&file_id="+r.id+"&type_id=2";$.ajax({url:u}).done((function(e){var t=l({},r,{mediaViewId:e.MediaViewId,played:r.played+1}),n=[].concat(i(S.slice(0,a)),[t],i(S.slice(a+1,S.length)));k(n)}))}else k(o)}(c,n)}function _(){document.getElementById("music-player-container-"+e.product.project_id).getElementsByTagName("audio")[0].pause(),E(!1),j(!0),I(e.items[f].musicSrc)}function I(t){var n=S.find((function(e){return e.musicSrc===t})),r=S.findIndex((function(e){return e.musicSrc===t})),a=l({},n,{stopped:n.stopped+1}),c=[].concat(i(S.slice(0,r)),[a],i(S.slice(r+1,S.length)));if(0===S[r].stopped){var o="https://"+window.location.hostname+"/p/"+e.product.project_id+"/stopmediaviewajax?media_view_id="+S[r].mediaViewId;$.ajax({url:o}).done((function(e){k(c)}))}else k(c)}return C[1],Object(r.useEffect)((function(){var t=document.getElementById("music-player-container-"+e.product.project_id).getElementsByTagName("audio"),n=e.items[f].musicSrc;t[0].src=n,t[0].volume=.5}),[]),Object(r.useEffect)((function(){g&&N(!0),w&&(v===f?N():N(!0)),!0===g&&I(e.items[v].musicSrc)}),[f]),a.a.useEffect((function(){u.current===e.product.project_id?!0===u.isPlaying?N(!0):_():!0===g&&_()}),[u.current,u.isPlaying]),a.a.createElement("div",{id:"music-player-container-"+e.product.project_id,className:"product-browse-music-player-wrapper"},a.a.createElement("audio",{volume:.5,id:"music-player-audio-"+e.product.project_id}),a.a.createElement(m,{playIndex:f,isPlaying:g,isPaused:w,isMobile:T,onPlayClick:function(t){p({type:"SET_CURRENT_ITEM",itemId:e.product.project_id,pIndex:f})},onPauseClick:function(){p({type:"PAUSE"})},onPrevTrackPlayClick:function(){var t;t=0===f?e.items.length-1:f-1,y(t)},onNextTrackPlayClick:function(){var t;t=f+1===e.items.length?0:f+1,y(t)},items:e.items}))}}}]);