(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{53:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),i=r(2),c=r(152);r(233),r(35);function o(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var c,o=e[Symbol.iterator]();!(n=(c=o.next()).done)&&(r.push(c.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(e){var t,r,n=a.a.createElement("svg",{fill:"currentColor",preserveAspectRatio:"xMidYMid meet",height:"1em",width:"1em",viewBox:"0 0 40 40",className:"play-icon"},a.a.createElement("g",null,a.a.createElement("path",{d:"m20.1 2.9q4.7 0 8.6 2.3t6.3 6.2 2.3 8.6-2.3 8.6-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3z m8.6 18.3q0.7-0.4 0.7-1.2t-0.7-1.2l-12.1-7.2q-0.7-0.4-1.5 0-0.7 0.4-0.7 1.3v14.2q0 0.9 0.7 1.3 0.4 0.2 0.8 0.2 0.3 0 0.7-0.2z"}))),i=a.a.createElement("svg",{fill:"currentColor",preserveAspectRatio:"xMidYMid meet",height:"1em",width:"1em",viewBox:"0 0 40 40",className:"pause-icon"},a.a.createElement("g",null,a.a.createElement("path",{d:"m18.7 26.4v-12.8q0-0.3-0.2-0.5t-0.5-0.2h-5.7q-0.3 0-0.5 0.2t-0.2 0.5v12.8q0 0.3 0.2 0.5t0.5 0.2h5.7q0.3 0 0.5-0.2t0.2-0.5z m10 0v-12.8q0-0.3-0.2-0.5t-0.5-0.2h-5.7q-0.3 0-0.5 0.2t-0.2 0.5v12.8q0 0.3 0.2 0.5t0.5 0.2h5.7q0.3 0 0.5-0.2t0.2-0.5z m8.6-6.4q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z"}))),o=a.a.createElement("svg",{fill:"currentColor",preserveAspectRatio:"xMidYMid meet",height:"1em",width:"1em",viewBox:"0 0 40 40",className:"prev-icon"},a.a.createElement("g",null,a.a.createElement("path",{d:"m15.9 20l14.1-10v20z m-5.9-10h3.4v20h-3.4v-20z"}))),l=a.a.createElement("svg",{fill:"currentColor",preserveAspectRatio:"xMidYMid meet",height:"1em",width:"1em",viewBox:"0 0 40 40",className:"next-icon"},a.a.createElement("g",null,a.a.createElement("path",{d:"m26.6 10h3.4v20h-3.4v-20z m-16.6 20v-20l14.1 10z"})));t=!0===e.isPlaying?!0===e.isMobile?a.a.createElement("span",{className:"pause-icon-wrapper",onTouchStart:function(){return e.onPauseClick()}},i):a.a.createElement("span",{className:"pause-icon-wrapper",onClick:function(){return e.onPauseClick()}},i):!0===e.isMobile?a.a.createElement("span",{className:"play-icon-wrapper",onTouchStart:function(){return e.onPlayClick()}},n):a.a.createElement("span",{className:"play-icon-wrapper",onClick:function(){return e.onPlayClick()}},n),r=!0===e.isMobile?a.a.createElement("div",{className:"music-player-audio-control"},a.a.createElement("span",{onTouchStart:function(){return e.onPrevTrackPlayClick()}},o),t,a.a.createElement("span",{onTouchStart:function(){return e.onNextTrackPlayClick()}},l)):a.a.createElement("div",{className:"music-player-audio-control"},a.a.createElement("span",{onClick:function(){return e.onPrevTrackPlayClick()}},o),t,a.a.createElement("span",{onClick:function(){return e.onNextTrackPlayClick()}},l));var u,s="music-player-controls-bar ";return e.isPlaying&&(s+="is-playing",u=a.a.createElement("div",{className:"music-player-progress-bar"},a.a.createElement(c.a,{railStyle:{backgroundColor:"rgba(19, 19, 19, 0.33)",height:"10px",borderRadius:"0px !important"},trackStyle:{backgroundColor:"rgb(49, 194, 124)",height:"10px",borderRadius:"0px !important"},handleStyle:{display:"none"},value:e.currentTrackProgress,onChange:function(t){return function(t){e.onChangeSliderPosition(t)}(t)}}))),a.a.createElement("div",{id:"music-player-control-panel"},a.a.createElement("div",{className:s},a.a.createElement("div",{className:"music-player-controls-wrapper"},r),a.a.createElement("div",{className:"track-number-display"},parseInt(e.playIndex+1)+" / "+e.items.length)),u)}t.default=function(e){var t,r,c=a.a.useContext(i.a),l=c.productBrowseState,s=c.productBrowseDispatch,p=m(Object(n.useState)(0),2),d=p[0],y=p[1],v=(t=d,r=Object(n.useRef)(),Object(n.useEffect)((function(){r.current=t}),[t]),r.current),h=m(Object(n.useState)(),2),b=h[0],g=h[1],E=m(Object(n.useState)(),2),w=E[0],j=E[1],S=[];e.items.forEach((function(e,t){var r=u(u({},e),{},{played:0,stopped:0});S.push(r)}));var O=m(Object(n.useState)(S),2),P=O[0],k=O[1],C=e.containerWidth<600,x=m(Object(n.useState)(C),2),T=x[0],N=(x[1],m(Object(n.useState)(),2)),I=(N[0],N[1]),M=m(Object(n.useState)(),2),_=M[0],A=M[1],B=m(Object(n.useState)(),2),q=(B[0],B[1]),z=m(Object(n.useState)(),2),R=z[0],D=z[1];function U(){s({type:"SET_CURRENT_ITEM",itemId:e.product.project_id,pIndex:d})}function Y(t,r){var n=document.getElementById("music-player-container-"+e.product.project_id).getElementsByTagName("audio"),a=r||d,i=e.items[a].musicSrc;(!1===w||n[0].currentTime&&0===n[0].currentTime||!0===t)&&(n[0].src=i),n[0].play(),g(!0),j(!1),function(t,r){var n=P.find((function(e){return e.musicSrc===t})),a=r||P.findIndex((function(e){return e.musicSrc===t})),i=u(u({},n),{},{played:n.played+1}),c=[].concat(o(P.slice(0,a)),[i],o(P.slice(a+1,P.length)));if(0===P[a].played){var l="https://"+window.location.hostname+"/p/"+e.product.project_id+"/startmediaviewajax?collection_id="+n.collection_id+"&file_id="+n.id+"&type_id=2";$.ajax({url:l}).done((function(e){var t=u(u({},n),{},{mediaViewId:e.MediaViewId,played:n.played+1}),r=[].concat(o(P.slice(0,a)),[t],o(P.slice(a+1,P.length)));k(r)}))}else k(c)}(i,r)}function V(){document.getElementById("music-player-container-"+e.product.project_id).getElementsByTagName("audio")[0].pause(),g(!1),j(!0),J(e.items[d].musicSrc)}function J(t){var r=P.find((function(e){return e.musicSrc===t})),n=P.findIndex((function(e){return e.musicSrc===t})),a=u(u({},r),{},{stopped:r.stopped+1}),i=[].concat(o(P.slice(0,n)),[a],o(P.slice(n+1,P.length)));if(0===P[n].stopped){var c="https://"+window.location.hostname+"/p/"+e.product.project_id+"/stopmediaviewajax?media_view_id="+P[n].mediaViewId;$.ajax({url:c}).done((function(e){k(i)}))}else k(i)}function L(e){var t=e.target,r=W(t.currentTime);I(r),A(t.duration);var n=t.duration;isNaN(n)&&(n=0),n=W(n),q(n);var a=t.currentTime/t.duration*100;D(a)}function W(e){var t=Math.floor(e/60),r=e-60*t;return t<10&&(t="0"+t),(r=Math.floor(r))<10&&(r="0"+r),t+":"+r}return Object(n.useEffect)((function(){var t=document.getElementById("music-player-container-"+e.product.project_id).getElementsByTagName("audio"),r=e.items[d].musicSrc;t[0].src=r,t[0].volume=.5,U()}),[]),Object(n.useEffect)((function(){b&&Y(!0),w&&(v===d?Y():Y(!0)),!0===b&&J(e.items[v].musicSrc)}),[d]),a.a.useEffect((function(){l.current===e.product.project_id?!0===l.isPlaying?Y(!0):V():!0===b&&V()}),[l.current,l.isPlaying]),a.a.createElement("div",{id:"music-player-container-"+e.product.project_id,className:"product-browse-music-player-wrapper"},a.a.createElement("audio",{volume:.5,id:"music-player-audio-"+e.product.project_id,onTimeUpdate:function(e){return L(e)},onLoadedMetadata:function(e){return L(e)}}),a.a.createElement(f,{playIndex:d,isPlaying:b,isPaused:w,isMobile:T,onPlayClick:function(e){return U()},onPauseClick:function(){s({type:"PAUSE"})},onPrevTrackPlayClick:function(){var t;t=0===d?e.items.length-1:d-1,y(t)},onNextTrackPlayClick:function(){var t;t=d+1===e.items.length?0:d+1,y(t)},items:e.items,currentTrackProgress:R,onChangeSliderPosition:function(t){var r=_/100*t,n=document.getElementById("music-player-container-"+e.product.project_id).getElementsByTagName("audio");console.log(r),n[0].currentTime=r}}))}}}]);