(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[5],{

/***/ "./modules/product-media-slider/app/components/comics-reader.js":
/*!**********************************************************************!*\
  !*** ./modules/product-media-slider/app/components/comics-reader.js ***!
  \**********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _product_media_slider_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../product-media-slider-helpers */ \"./modules/product-media-slider/app/product-media-slider-helpers.js\");\n/* harmony import */ var _style_comic_reader_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./../../style/comic-reader.css */ \"./modules/product-media-slider/style/comic-reader.css\");\n/* harmony import */ var _style_comic_reader_css__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_style_comic_reader_css__WEBPACK_IMPORTED_MODULE_2__);\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n\n\n\n\nfunction ComicsReaderWrapper(props) {\n  var _useState = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])('Loading...'),\n      _useState2 = _slicedToArray(_useState, 2),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      comicBookInitiated = _useState4[0],\n      setComicBookInitiated = _useState4[1];\n\n  var _useState5 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      pages = _useState6[0],\n      setPages = _useState6[1];\n\n  var _useState7 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      viewedPagesCount = _useState8[0],\n      setViewedPagesCount = _useState8[1];\n\n  var _useState9 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      comicBookReadIsReported = _useState10[0],\n      setComicBookReadIsReported = _useState10[1];\n  /* INIT */\n\n\n  react__WEBPACK_IMPORTED_MODULE_0___default.a.useEffect(function () {\n    if (props.slideIndex === props.currentSlide) {\n      setComicBookInitiated(true);\n      initComicBook();\n    }\n  }, [props.slideIndex, props.currentSlide]);\n  react__WEBPACK_IMPORTED_MODULE_0___default.a.useEffect(function () {\n    if (viewedPagesCount > 3 && comicBookReadIsReported === false) {\n      reportComicBookRead();\n    }\n  }, [viewedPagesCount]);\n\n  function initComicBook() {\n    var url = json_server_comics + \"/api/files/toc?id=\" + props.slide.file_id + \"&format=json\";\n    $.ajax({\n      url: url\n    }).done(function (res) {\n      var pages = Object(_product_media_slider_helpers__WEBPACK_IMPORTED_MODULE_1__[\"renderPages\"])(res.files, props.slide.file_id);\n      setPages(pages);\n    });\n  }\n\n  function _onViewPage() {\n    var newViewedPagedCount = viewedPagesCount + 1;\n    setViewedPagesCount(newViewedPagedCount);\n  }\n\n  function reportComicBookRead() {\n    console.log('report comic book reading');\n    console.log(props);\n    var comicReadReportUrl = \"https://\" + window.location.hostname + \"/p/\" + props.product.project_id + '/startmediaviewajax?collection_id=' + props.slide.collection_id + '&file_id=' + props.slide.file_id + '&type_id=3';\n    $.ajax({\n      url: comicReadReportUrl\n    }).done(function (res) {\n      console.log(res);\n      setComicBookReadIsReported(true);\n    });\n  }\n  /* COMPONENT */\n\n\n  var comicsReaderDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n    id: \"ajax-loader\"\n  });\n\n  if (pages.length > 0) {\n    comicsReaderDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(ComicBookReader, {\n      pages: pages,\n      slideIndex: props.slideIndex,\n      comicsFileName: props.slide.title,\n      onFullScreenToggle: props.onFullScreenToggle,\n      isFullScreen: props.isFullScreen,\n      onViewPage: function onViewPage(page) {\n        return _onViewPage(page);\n      }\n    });\n  }\n\n  return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    id: \"comics-reader-wrapper\"\n  }, comicsReaderDisplay);\n}\n\nfunction ComicBookReader(props) {\n  var _useState11 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      loading = _useState12[0],\n      setLoading = _useState12[1];\n\n  var _useState13 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(\"single\"),\n      _useState14 = _slicedToArray(_useState13, 2),\n      displayType = _useState14[0],\n      setDisplayType = _useState14[1];\n\n  var _useState15 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(Object(_product_media_slider_helpers__WEBPACK_IMPORTED_MODULE_1__[\"generatePagesArray\"])(props.pages, displayType)),\n      _useState16 = _slicedToArray(_useState15, 2),\n      pages = _useState16[0],\n      setPages = _useState16[1];\n\n  var _useState17 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(0),\n      _useState18 = _slicedToArray(_useState17, 2),\n      currentPage = _useState18[0],\n      setCurrentPage = _useState18[1];\n\n  var _useState19 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(pages.length),\n      _useState20 = _slicedToArray(_useState19, 2),\n      totalPages = _useState20[0],\n      setTotalPages = _useState20[1];\n\n  var _useState21 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])('normal'),\n      _useState22 = _slicedToArray(_useState21, 2),\n      viewMode = _useState22[0],\n      setViewMode = _useState22[1];\n\n  react__WEBPACK_IMPORTED_MODULE_0___default.a.useEffect(function () {\n    initComicReader();\n  }, []);\n\n  function initComicReader() {\n    var bookBlockElement = document.getElementById('bb-bookblock');\n\n    if (bookBlockElement) {\n      $(document).ready(function () {\n        window.comicSwiper = new Swiper('.comic-book-reader', {\n          speed: 400,\n          initialSlide: 0,\n          observer: true,\n          observeParents: true,\n          preloadImages: true,\n          updateOnImagesReady: true,\n          nested: true,\n          threshold: 0,\n          onSlideChangeStart: function onSlideChangeStart(swiper) {\n            setCurrentPage(swiper.activeIndex);\n          }\n        });\n        window.comicSwiper.update();\n      });\n    } else {\n      setTimeout(function () {\n        initComicReader();\n      }, 500);\n    }\n  }\n\n  function onComicReaderNavClick(val) {\n    var nextPage;\n    if (val === \"first\") nextPage = 0;else if (val === \"last\") nextPage = totalPages;else if (val === \"prev\") nextPage = currentPage === 0 ? 0 : currentPage - 1;else if (val === \"next\") nextPage = currentPage === totalPages ? totalPages : currentPage + 1;\n    window.comicSwiper.slideTo(nextPage);\n    props.onViewPage(nextPage);\n  }\n\n  function onBeforeFlip(page) {\n    return false;\n  }\n\n  function readerOnEndFlip(page, isLimit) {\n    setCurrentPage(isLimit + 1);\n    return false;\n  }\n\n  var comicBookDisplay;\n  if (loading) comicPages = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n    id: \"ajax-loader\"\n  });else {\n    var _comicPages = pages.map(function (p, index) {\n      return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n        className: \"swiper-slide\",\n        key: index\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"img\", {\n        src: p\n      }));\n    });\n\n    comicBookDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      id: \"bb-bookblock\",\n      className: \"swiper-wrapper\"\n    }, _comicPages);\n  }\n  return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"comic-book-reader swiper-container \" + viewMode\n  }, comicBookDisplay, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"nav-container\"\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"nav\", null, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    id: \"bb-nav-counter\"\n  }, currentPage + 1 + \"/\" + totalPages), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    id: \"bb-nav-first\",\n    onClick: function onClick() {\n      return onComicReaderNavClick('first');\n    }\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n    className: \"glyphicon glyphicon-step-backward\"\n  })), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    id: \"bb-nav-prev\",\n    onClick: function onClick() {\n      return onComicReaderNavClick('prev');\n    }\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n    className: \"glyphicon glyphicon-triangle-left\"\n  })), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    id: \"bb-nav-next\",\n    onClick: function onClick() {\n      return onComicReaderNavClick('next');\n    }\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n    className: \"glyphicon glyphicon-triangle-right\"\n  })), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    id: \"bb-nav-last\",\n    onClick: function onClick() {\n      return onComicReaderNavClick('last');\n    }\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n    className: \"glyphicon glyphicon-step-forward\"\n  })), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    id: \"bb-nav-viewmode\",\n    onClick: function onClick() {\n      return props.onFullScreenToggle(props.isFullScreen === true ? false : true);\n    }\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n    className: \"glyphicon glyphicon-fullscreen\"\n  }))), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n    className: \"title\"\n  }, props.comicsFileName)));\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (ComicsReaderWrapper);\n\n//# sourceURL=webpack:///./modules/product-media-slider/app/components/comics-reader.js?");

/***/ }),

/***/ "./modules/product-media-slider/style/comic-reader.css":
/*!*************************************************************!*\
  !*** ./modules/product-media-slider/style/comic-reader.css ***!
  \*************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var api = __webpack_require__(/*! ../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ \"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = __webpack_require__(/*! !../../../node_modules/css-loader/dist/cjs.js!./comic-reader.css */ \"./node_modules/css-loader/dist/cjs.js!./modules/product-media-slider/style/comic-reader.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.i, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};\n\n//# sourceURL=webpack:///./modules/product-media-slider/style/comic-reader.css?");

/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./modules/product-media-slider/style/comic-reader.css":
/*!***************************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./modules/product-media-slider/style/comic-reader.css ***!
  \***************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("// Imports\nvar ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/api.js */ \"./node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.i, \"#comics-reader-wrapper {\\n  height: 100%;\\n  position: relative;\\n}\\n#comics-reader-wrapper #ajax-loader {\\n  width: 24px;\\n  height: 24px;\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  margin-left: -12px;\\n  margin-top: -12px;\\n  background-color: white;\\n}\\n#comics-reader-wrapper .comic-book-reader {\\n  height: 100%;\\n  position: relative;\\n  padding-bottom: 60px;\\n}\\n#comics-reader-wrapper .comic-book-reader .bb-bookblock {\\n  width: 450px;\\n  height: 100%;\\n}\\n#comics-reader-wrapper .comic-book-reader .bb-bookblock .bb-item img,\\n#comics-reader-wrapper .comic-book-reader .bb-bookblock .bb-page img {\\n  width: 50%;\\n  float: left;\\n}\\n#comics-reader-wrapper .nav-container {\\n  width: 100%;\\n  text-align: center;\\n  position: absolute;\\n  bottom: 0;\\n  z-index: 111;\\n  height: 58px;\\n}\\n#comics-reader-wrapper .nav-container nav {\\n  width: auto;\\n  height: 34px;\\n  margin: 0 auto 0;\\n  display: table;\\n}\\n#comics-reader-wrapper .nav-container nav a {\\n  display: block;\\n  min-width: 30px;\\n  height: 30px;\\n  text-align: center;\\n  border-radius: 2px;\\n  background: rgba(0, 0, 0, 0.35);\\n  color: #fff;\\n  margin: 2px;\\n  float: left;\\n  cursor: pointer;\\n}\\n#comics-reader-wrapper .nav-container nav a .glyphicon {\\n  top: 7px;\\n}\\n#comics-reader-wrapper .nav-container nav a:hover {\\n  opacity: 0.6;\\n}\\n#comics-reader-wrapper .nav-container nav a#bb-nav-counter {\\n  line-height: 30px;\\n  font-size: 12px;\\n}\\n#comics-reader-wrapper .nav-container > span.title {\\n  display: inline-block;\\n  /* min-width: 30px; */\\n  height: auto;\\n  text-align: center;\\n  border-radius: 2px;\\n  background: rgba(0, 0, 0, 0.35);\\n  color: #fff;\\n  margin: 2px;\\n  /* float: left; */\\n  cursor: pointer;\\n  font-size: 12px;\\n  padding: 4px;\\n}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n\n\n//# sourceURL=webpack:///./modules/product-media-slider/style/comic-reader.css?./node_modules/css-loader/dist/cjs.js");

/***/ })

}]);